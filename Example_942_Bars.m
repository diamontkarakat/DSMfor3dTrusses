clc;clear all;close all;

%% Basic DATA
%This is 942 Bar 3d Truss
T.node =[1 -84 -84 3744;2 84 -84 3744;3 84 84 3744;4 -84 84 3744;5 -84 -84 3600;6 84 -84 3600;7 84 84 3600;8 -84 84 3600;9 -84 -84 3456;10 84 -84 3456;11 84 84 3456;12 -84 84 3456;13 -84 -84 3312;14 84 -84 3312;15 84 84 3312;16 -84 84 3312;17 -84 -84 3168;18 84 -84 3168;19 84 84 3168;20 -84 84 3168;21 -84 -84 3024;22 84 -84 3024;23 84 84 3024;24 -84 84 3024;25 -210 0 2880;26 -168 -168 2880;27 0 -210 2880;28 168 -168 2880;29 210 0 2880;30 168 168 2880;31 0 210 2880;32 -168 168 2880;33 -210 0 2736;34 -168 -168 2736;35 0 -210 2736;36 168 -168 2736;37 210 0 2736;38 168 168 2736;39 0 210 2736;40 -168 168 2736;41 -210 0 2592;42 -168 -168 2592;43 0 -210 2592;44 168 -168 2592;45 210 0 2592;46 168 168 2592;47 0 210 2592;48 -168 168 2592;49 -210 0 2448;50 -168 -168 2448;51 0 -210 2448;52 168 -168 2448;53 210 0 2448;54 168 168 2448;55 0 210 2448;56 -168 168 2448;57 -210 0 2304;58 -168 -168 2304;59 0 -210 2304;60 168 -168 2304;61 210 0 2304;62 168 168 2304;63 0 210 2304;64 -168 168 2304;65 -210 0 2160;66 -168 -168 2160;67 0 -210 2160;68 168 -168 2160;69 210 0 2160;70 168 168 2160;71 0 210 2160;72 -168 168 2160;73 -210 0 2016;74 -168 -168 2016;75 0 -210 2016;76 168 -168 2016;77 210 0 2016;78 168 168 2016;79 0 210 2016;80 -168 168 2016;81 -210 0 1872;82 -168 -168 1872;83 0 -210 1872;84 168 -168 1872;85 210 0 1872;86 168 168 1872;87 0 210 1872;88 -168 168 1872;89 -294 -84 1728;90 -252 -252 1728;91 -84 -294 1728;92 84 -294 1728;93 252 -252 1728;94 294 -84 1728;95 294 84 1728;96 252 252 1728;97 84 294 1728;98 -84 294 1728;99 -252 252 1728;100 -294 84 1728;101 -294 -84 1584;102 -252 -252 1584;103 -84 -294 1584;104 84 -294 1584;105 252 -252 1584;106 294 -84 1584;107 294 84 1584;108 252 252 1584;109 84 294 1584;110 -84 294 1584;111 -252 252 1584;112 -294 84 1584;113 -294 -84 1440;114 -252 -252 1440;115 -84 -294 1440;116 84 -294 1440;117 252 -252 1440;118 294 -84 1440;119 294 84 1440;120 252 252 1440;121 84 294 1440;122 -84 294 1440;123 -252 252 1440;124 -294 84 1440;125 -294 -84 1296;126 -252 -252 1296;127 -84 -294 1296;128 84 -294 1296;129 252 -252 1296;130 294 -84 1296;131 294 84 1296;132 252 252 1296;133 84 294 1296;134 -84 294 1296;135 -252 252 1296;136 -294 84 1296;137 -294 -84 1152;138 -252 -252 1152;139 -84 -294 1152;140 84 -294 1152;141 252 -252 1152;142 294 -84 1152;143 294 84 1152;144 252 252 1152;145 84 294 1152;146 -84 294 1152;147 -252 252 1152;148 -294 84 1152;149 -294 -84 1008;150 -252 -252 1008;151 -84 -294 1008;152 84 -294 1008;153 252 -252 1008;154 294 -84 1008;155 294 84 1008;156 252 252 1008;157 84 294 1008;158 -84 294 1008;159 -252 252 1008;160 -294 84 1008;161 -294 -84 864;162 -252 -252 864;163 -84 -294 864;164 84 -294 864;165 252 -252 864;166 294 -84 864;167 294 84 864;168 252 252 864;169 84 294 864;170 -84 294 864;171 -252 252 864;172 -294 84 864;173 -294 -84 720;174 -252 -252 720;175 -84 -294 720;176 84 -294 720;177 252 -252 720;178 294 -84 720;179 294 84 720;180 252 252 720;181 84 294 720;182 -84 294 720;183 -252 252 720;184 -294 84 720;185 -294 -84 576;186 -252 -252 576;187 -84 -294 576;188 84 -294 576;189 252 -252 576;190 294 -84 576;191 294 84 576;192 252 252 576;193 84 294 576;194 -84 294 576;195 -252 252 576;196 -294 84 576;197 -294 -84 432;198 -252 -252 432;199 -84 -294 432;200 84 -294 432;201 252 -252 432;202 294 -84 432;203 294 84 432;204 252 252 432;205 84 294 432;206 -84 294 432;207 -252 252 432;208 -294 84 432;209 -294 -84 288;210 -252 -252 288;211 -84 -294 288;212 84 -294 288;213 252 -252 288;214 294 -84 288;215 294 84 288;216 252 252 288;217 84 294 288;218 -84 294 288;219 -252 252 288;220 -294 84 288;221 -294 -84 144;222 -252 -252 144;223 -84 -294 144;224 84 -294 144;225 252 -252 144;226 294 -84 144;227 294 84 144;228 252 252 144;229 84 294 144;230 -84 294 144;231 -252 252 144;232 -294 84 144;233 -378 -84 0;234 -336 -336 0;235 -84 -378 0;236 84 -378 0;237 336 -336 0;238 378 -84 0;239 378 84 0;240 336 336 0;241 84 378 0;242 -84 378 0;243 -336 336 0;244 -378 84 0]
T.element = [1 3;2 4;1 2;2 3;3 4;4 1;5 6;6 7;7 8;8 5;1 5;2 6;3 7;4 8;5 9;6 10;7 11;8 12;1 6;2 7;3 8;4 5;5 2;6 3;7 4;1 8;5 10;6 11;7 12;8 9;9 6;10 7;11 8;5 12;9 10;10 11;11 12;12 9;13 14;14 15;15 16;16 13;17 18;18 19;19 20;20 17;9 13;10 14;11 15;12 16;13 17;14 18;15 19;16 20;17 21;18 22;19 23;20 24;9 14;10 15;11 16;12 13;13 10;14 11;15 12;9 16;13 18;14 19;15 20;16 17;17 14;18 15;19 16;13 20;17 22;18 23;19 24;20 21;21 18;22 19;23 20;17 24;21 22;22 23;23 24;24 21;21 26;22 28;23 30;24 32;21 28;22 30;23 32;24 26;26 22;28 23;30 24;32 21;21 27;22 29;23 31;24 25;21 25;22 27;23 29;24 31;25 26;26 27;27 28;28 29;29 30;30 31;31 32;32 25;33 34;34 35;35 36;36 37;37 38;38 39;39 40;40 33;26 34;28 36;30 38;32 40;34 42;36 44;38 46;40 48;25 34;26 35;27 36;28 37;29 38;30 39;31 40;32 33;33 26;34 27;35 28;36 29;37 30;38 31;39 32;40 25;33 42;34 43;35 44;36 45;37 46;38 47;39 48;40 41;41 34;42 35;43 36;44 37;45 38;46 39;47 40;48 33;25 33;27 35;29 37;31 39;33 41;35 43;37 45;39 47;41 42;42 43;43 44;44 45;45 46;46 47;47 48;48 41;49 50;50 51;51 52;52 53;53 54;54 55;55 56;56 49;42 50;44 52;46 54;48 56;50 58;52 60;54 62;56 64;41 50;42 51;43 52;44 53;45 54;46 55;47 56;48 49;49 42;50 43;51 44;52 45;53 46;54 47;55 48;56 41;49 58;50 59;51 60;52 61;53 62;54 63;55 64;56 57;57 50;58 51;59 52;60 53;61 54;62 55;63 56;64 49;41 49;43 51;45 53;47 55;49 57;51 59;53 61;55 63;57 58;58 59;59 60;60 61;61 62;62 63;63 64;64 57;65 66;66 67;67 68;68 69;69 70;70 71;71 72;72 65;73 74;74 75;75 76;76 77;77 78;78 79;79 80;80 73;58 66;60 68;62 70;64 72;66 74;68 76;70 78;72 80;74 82;76 84;78 86;80 88;57 66;58 67;59 68;60 69;61 70;62 71;63 72;64 65;65 58;66 59;67 60;68 61;69 62;70 63;71 64;72 57;65 74;66 75;67 76;68 77;69 78;70 79;71 80;72 73;73 66;74 67;75 68;76 69;77 70;78 71;79 72;80 65;73 82;74 83;75 84;76 85;77 86;78 87;79 88;80 81;81 74;82 75;83 76;84 77;85 78;86 79;87 80;88 73;57 65;59 67;61 69;63 71;65 73;67 75;69 77;71 79;73 81;75 83;77 85;79 87;81 82;82 83;83 84;84 85;85 86;86 87;87 88;88 81;90 82;93 84;96 86;99 88;81 90;90 83;83 93;93 85;85 96;96 87;87 99;99 81;89 82;82 91;92 84;84 94;95 86;86 97;98 88;88 100;83 91;85 94;87 97;81 100;81 89;83 92;85 95;87 98;89 90;90 91;92 93;93 94;95 96;96 97;98 99;99 100;101 102;102 103;104 105;105 106;107 108;108 109;110 111;111 112;91 92;94 95;97 98;100 89;103 104;106 107;109 110;112 101;90 102;93 105;96 108;99 111;102 114;105 117;108 120;111 123;89 102;90 103;101 90;102 91;92 105;93 106;104 93;105 94;95 108;96 109;107 96;108 97;98 111;99 112;110 99;111 100;101 114;102 115;113 102;114 103;104 117;105 118;116 128;117 129;107 120;108 121;119 108;120 109;110 123;111 124;122 111;123 112;91 103;94 106;97 109;100 112;89 101;92 104;95 107;98 110;103 115;106 118;109 121;112 124;101 113;104 116;107 119;110 122;91 104;94 107;97 110;100 101;103 92;106 95;109 98;89 112;103 116;106 119;109 122;112 113;115 104;118 107;121 110;101 124;113 114;114 115;116 117;117 118;119 120;120 121;122 123;123 124;125 126;126 127;128 129;129 130;131 132;132 133;134 135;135 136;137 138;138 139;140 141;141 142;143 144;144 145;146 147;147 148;115 116;118 119;121 122;124 113;127 128;130 131;133 134;136 125;139 140;142 143;145 146;148 137;114 126;117 129;120 132;123 135;126 138;129 141;132 144;135 147;138 150;141 153;144 156;147 159;113 126;114 127;125 114;126 115;116 129;117 130;128 117;129 118;119 132;120 133;131 120;132 121;122 135;123 136;134 123;135 124;125 138;126 139;137 126;138 127;128 141;129 142;140 152;141 153;131 144;132 145;143 132;144 133;134 147;135 148;146 135;147 136;137 150;138 151;149 138;150 139;140 153;141 154;152 141;153 142;143 156;144 157;155 144;156 145;146 159;147 160;158 147;159 148;115 127;118 130;121 133;124 136;113 125;116 128;119 131;122 134;127 139;130 142;133 145;136 148;125 137;128 140;131 143;134 146;139 151;142 154;145 157;148 160;137 149;140 152;143 155;146 158;115 128;118 131;121 134;124 125;125 114;128 117;131 120;113 136;127 140;130 143;133 146;136 137;139 128;142 131;145 134;125 148;139 152;142 155;145 158;148 149;151 140;154 143;157 146;137 160;149 150;150 151;152 153;153 154;155 156;156 157;158 159;159 160;161 162;162 163;164 165;165 166;167 168;168 169;170 171;171 172;173 174;174 175;176 177;177 178;179 180;180 181;182 183;183 184;151 152;154 155;157 158;160 149;163 164;166 167;169 170;172 161;175 176;178 179;181 182;184 173;150 162;153 165;156 168;159 171;162 174;165 177;168 180;171 183;174 186;177 189;180 192;183 195;149 162;150 163;161 150;162 151;152 165;153 166;164 153;165 154;155 168;156 169;167 156;168 157;158 171;159 172;170 159;171 160;161 174;162 175;173 162;174 163;164 177;165 178;176 188;177 189;167 180;168 181;179 168;180 169;170 183;171 184;182 171;183 172;173 186;174 187;185 174;186 175;176 189;177 190;188 177;189 178;179 192;180 193;191 180;192 181;182 195;183 196;194 183;195 184;151 163;154 166;157 169;160 172;149 161;152 164;155 167;158 170;163 175;166 178;169 181;172 184;161 173;164 176;167 179;170 182;175 187;178 190;181 193;184 196;173 185;176 188;179 191;182 194;151 164;154 167;157 170;160 161;161 150;164 153;167 156;149 172;163 176;166 179;169 182;172 173;175 164;178 167;181 170;161 184;175 188;178 191;181 194;184 185;187 176;190 179;193 182;173 196;185 186;186 187;188 189;189 190;191 192;192 193;194 195;195 196;197 198;198 199;200 201;201 202;203 204;204 205;206 207;207 208;209 210;210 211;212 213;213 214;215 216;216 217;218 219;219 220;187 188;190 191;193 194;196 185;199 200;202 203;205 206;208 197;211 212;214 215;217 218;220 209;186 198;189 201;192 204;195 207;198 210;201 213;204 216;207 219;210 222;213 225;216 228;219 231;185 198;186 199;197 186;198 187;188 201;189 202;200 189;201 190;191 204;192 205;203 192;204 193;194 207;195 208;206 195;207 196;197 210;198 211;209 198;210 199;200 213;201 214;212 224;213 225;203 216;204 217;215 204;216 205;206 219;207 220;218 207;219 208;209 222;210 223;221 210;222 211;212 225;213 226;224 213;225 214;215 228;216 229;227 216;228 217;218 231;219 232;230 219;231 220;187 199;190 202;193 205;196 208;185 197;188 200;191 203;194 206;199 211;202 214;205 217;208 220;197 209;200 212;203 215;206 218;211 223;214 226;217 229;220 232;209 221;212 224;215 227;218 230;187 200;190 203;193 206;196 197;197 186;200 189;203 192;185 208;199 212;202 215;205 218;208 209;211 200;214 203;217 206;197 220;211 224;214 227;217 230;220 221;223 212;226 215;229 218;209 232;221 222;222 223;224 225;225 226;227 228;228 229;230 231;231 232;223 224;226 227;229 230;232 221;222 234;225 237;228 240;231 243;234 223;237 226;240 229;243 232;221 234;224 237;227 240;230 243;233 222;236 225;239 228;242 231;222 235;225 238;228 241;231 244;223 235;226 238;229 241;232 244;221 233;224 236;227 239;230 242;223 236;226 239;229 242;235 224;238 227;241 230;244 221;233 232];

NofNodes = size(T.node,1);% Number of Nodes
NofElements = size(T.element,1);% Number of Elements

T.A = ones(NofElements,1)*0.001; % Area for each Element
T.E = ones(NofElements,1)*100e9; % Young Module fro each Element
T.Supports = [233 1 1 1;234 1 1 1;234 1 1 1;236 1 1 1;237 1 1 1;238 1 1 1;239 1 1 1; 240 1 1 1; 241 1 1 1; 242 1 1 1; 243 1 1 1; 244 1 1 1]; % Node/ degree of freedom of Node in each local directory xyz, 1 = fix  0= free 
T.ExternalForces= [1 2e6 2e6 -2e6;2 2e6 2e6 -2e6;3 2e6 2e6 -2e6;4 2e6 2e6 -2e6;];% Node / Force X direction / Force Y direction /Force X direction
%% Solve Truss
Tr=DSMfor3dTrusses(T);
%% Plot Truss
Plot3DTruss(T.node,T.element,T.Supports,T.ExternalForces,Tr.U,Tr.elementStress,0.0001,0.0001)